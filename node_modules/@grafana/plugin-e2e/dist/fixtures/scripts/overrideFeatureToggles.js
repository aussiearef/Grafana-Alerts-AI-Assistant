'use strict';

const overrideFeatureToggles = (featureToggles) => {
  const timeout = 1;
  const waitForGrafanaBootData = (cb) => {
    if (window?.grafanaBootData?.settings?.featureToggles) {
      cb();
    } else {
      setTimeout(() => waitForGrafanaBootData(cb), timeout);
    }
  };
  waitForGrafanaBootData(() => {
    console.log("@grafana/plugin-e2e: setting the following feature toggles", featureToggles);
    window.grafanaBootData.settings.featureToggles = {
      ...window.grafanaBootData.settings.featureToggles,
      ...featureToggles
    };
  });
};

exports.overrideFeatureToggles = overrideFeatureToggles;
