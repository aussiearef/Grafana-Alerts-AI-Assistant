'use strict';

var ComponentBase = require('./ComponentBase.js');

class UnitPicker extends ComponentBase.ComponentBase {
  constructor(ctx, element) {
    super(ctx, element);
  }
  async selectOption(value, options) {
    await this.element.getByRole("textbox").click();
    const option = await this.getOption(value, options);
    await option.click(options);
  }
  async getOption(selector, options) {
    const steps = selector.split(">").map((step) => step.trim());
    const container = this.ctx.page.locator(this.ctx.selectors.constants.Cascader.menu(""));
    if (steps.length === 0) {
      throw new Error(`Could not find options from passed selector: ${selector}`);
    }
    const last = steps.pop();
    for (const step of steps) {
      await container.getByTitle(step, { exact: true }).click(options);
    }
    return container.getByRole("menuitemcheckbox", { exact: true, name: last });
  }
}

exports.UnitPicker = UnitPicker;
